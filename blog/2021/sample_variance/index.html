<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Why is the Denominator of Sample Variance n-1? | Zeyun Zhong</title> <meta name="author" content="Zeyun Zhong"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?e087b27490cd3d072797d04d4fc7ed65"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/luna.jpeg?3412bc233bd226753623e0a45dbe37de"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zeyun-zhong.github.io/blog/2021/sample_variance/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Zeyun </span>Zhong</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Why is the Denominator of Sample Variance n-1?</h1> <p class="post-meta">October 6, 2021</p> <p class="post-tags"> <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="mathematical-expectation">Mathematical Expectation</h2> <p>If $f(x)$ is the <a href="https://en.wikipedia.org/wiki/Probability_mass_function" rel="external nofollow noopener" target="_blank">probability mass function</a> (p.m.f.) of the discrete random variable $X$ with support $S$, and if the summation:</p> \[\sum_{x\in S} u(x)f(x)\] <p>exists (less than $\infty$), then the resulting sum is called the <strong>mathematical expectation</strong>, or the expected value of the function $u(X)$, where $x$ denotes individual sample point. The expectation of the function $u(X)$ is denoted as $E[u(X)]$:</p> \[E[u(X)] = \sum_{x\in S} u(x)f(x).\] <h2 id="population-mean-and-variance">Population Mean and Variance</h2> <p>If we consider one particular function: $u(X) = X$, then the expectation of $u(X)$:</p> \[E[u(X)] = E[X] = \sum_{x\in S} xf(x),\] <p>is called the <strong>expected value</strong> of $X$, denoted as $E[X]$. Or, it is called the <strong>mean</strong> of $X$, denoted as $\mu$.</p> <p>Now, let’s consider another function: $u(X) = (X-\mu)^2$, the corresponding expectation:</p> \[E[u(X)] = E[(X-\mu)^2] = \sum_{x\in S}(x-\mu)^2f(x),\] <p>is called the <strong>variance</strong> of $X$, denoted as $\mathrm{Var}(X)$ or $\sigma^2$.</p> <h2 id="sample-mean-and-variance">Sample Mean and Variance</h2> <p>If the population is too large and we still want to decribe the population using mean and variance, then it would be useful to select a sample and calculate the sample mean and sample variance.</p> <p>The <strong>sample mean</strong> is simply the average of the $n$ data points $x_1$, $x_2$, …, $x_n$:</p> \[\bar{x} = \frac{x_1+x_2+...+x_n}{n} = \frac{1}{n}\sum_{i=1}^n x_i.\] <p>The <strong>sample variance</strong> summaries the “spread” or “variation” of the data:</p> \[\begin{aligned} s^2 &amp;= \frac{(x_1-\bar{x})^2+(x_2-\bar{x})^2+ ... +(x_n-\bar{x})^2}{n-1} \\ &amp;= \frac{1}{n-1}\sum_{i=1}^n(x_i-\bar{x})^2. \end{aligned}\] <h2 id="important-properties">Important Properties</h2> <p>Note that the denominator of the sample variance is $n-1$. Why is that? Before we start to analyse that, we first look at some important properties of expectation. The proof will be given in the next section.</p> <p><strong>Property 1</strong>:</p> <p>if c is a constant, then $E[c] = c$ and $E[cu(X)] = cE[u(X)]$.</p> <p><strong>Property 2</strong>:</p> <p>$E[u_1(X) + u_2(X)] = E[u_1(X)] + E[u_2(X)]$.</p> <p><strong>Property 3</strong>:</p> <p>if $X_1$, $X_2$, …, $X_n$ are $n$ independent random variables with means $\mu_1$, $\mu_2$, …, $\mu_n$ and variances $\sigma_1^2$, $\sigma_2^2$, …, $\sigma_n^2$. Then, the mean and variance of the linear combination $Y = \sum_{i=1}^{n}a_iX_i$ ($a_i$ are real constants) are:</p> \[\begin{aligned} \mu_Y &amp;= \sum_{i=1}^n a_i\mu_i \\ \sigma_Y^2 &amp;= \sum_{i=1}^n a_i^2 \sigma_i^2. \end{aligned}\] <h2 id="proof">Proof</h2> <p>Let’s do some proof in this section.</p> <p><strong>Property 1</strong>:</p> \[\begin{aligned} E[c] &amp;= \sum_{x\in S}cf(x) = c\sum_{x\in S}f(x) = c \times 1 = c \\ E[cu(X)] &amp;= \sum_{x\in S}cu(X)f(x) = c\sum_{x\in S}u(X)f(x) = cE[u(X)]. \end{aligned}\] <p><strong>Property 2</strong>:</p> \[\begin{aligned} E[u_1(X) + u_2(X)] &amp;= \sum_{x\in S} (u_1(X) + u_2(X))f(x) \\ &amp;= \sum_{x\in S} u_1(X)f(x) + \sum_{x\in S} u_2(X)f(x) \\ &amp;= E[u_1(X)] + E[u_2(X)] \end{aligned}\] <p><strong>Property 3</strong>:</p> \[\begin{aligned} \mu_Y &amp;= E[Y] = E[\sum_{i=1}^n a_iX_i] = \sum_{i=1}^n E[a_iX_i] \\ &amp;= \sum_{i=1}^n a_i E[X_i] = \sum_{i=1}^n a_i\mu_i \end{aligned}\] \[\begin{aligned} \sigma_Y^2 &amp;= E[(Y-\mu_Y)^2] \\ &amp;= E[(\sum_{i=1}^n a_iX_i - \sum_{i=1}^n a_i\mu_i)^2] \\ &amp;= E[(\sum_{i=1}^na_i(X_i-\mu_i))^2] \\ &amp;= E[(\sum_{i=1}^na_i(X_i-\mu_i))\cdot (\sum_{j=1}^na_j(X_j-\mu_j))] \\ &amp;= E[\sum_{i=1}^n\sum_{j=1}^n a_ia_j(X_i-\mu_i)(X_j-\mu_j)] \\ &amp;= \sum_{i=1}^n\sum_{j=1}^n a_ia_j E[(X_i-\mu_i)(X_j-\mu_j)]. \end{aligned}\] <p>Since $X_1$, $X_2$, …, $X_n$ are independent random variables, the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" rel="external nofollow noopener" target="_blank">correlation</a> between two arbitrary variables $X_i$ and $X_j$ with $i\neq j$ is zero. This leads us to:</p> \[\sigma_Y^2 = \sum_{i=1}^n a_i^2 E[(X_i-\mu_i)^2] = \sum_{i=1}^n a_i^2 \sigma_i^2.\] <h2 id="why-is-the-denominator-of-sample-variance-n-1">Why is the Denominator of Sample Variance n-1?</h2> <p>If we take the number of data points $n$ as the denominator of the sample variance, we will see that this sample variance is a biased estimator of the population variance:</p> \[\begin{aligned} s_n^2 &amp;= E[\frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2] \\ &amp;= E[\frac{1}{n}\sum_{i=1}^n[(x_i-\mu)-(\bar{x}-\mu)]^2] \\ &amp;= E[\frac{1}{n}\sum_{i=1}^n(x_i-\mu)^2-2(x_i-\mu)\underbrace{(\bar{x}-\mu)}_{const.}+\underbrace{(\bar{x}-\mu)^2}_{const.}] \\ &amp;= E[\frac{1}{n}\sum_{i=1}^n(x_i-\mu)^2 - \frac{2(\bar{x}-\mu)}{n}\underbrace{\sum_{i=1}^n(x_i}_{n\cdot\bar{x}}-\mu) + (\bar{x}-\mu)^2] \\ &amp;= E[(X-\mu)^2]- E[2(\bar{x}-\mu)(\bar{x}-\mu)] + E[(\bar{x}-\mu)^2]]\\ &amp;= E[(X-\mu)^2] -E[(\bar{x}-\mu)^2] \\ &amp;= \sigma^2 - \mathrm{Var}(\bar{x}) \\ \end{aligned}\] <p>The bias is therefore $\mathrm{Var}(\bar{x})$, i.e. variance of the sample mean. According to the Property 3, this term can be calculated by:</p> \[\begin{aligned} \mathrm{Var}(\bar{x}) &amp;= \mathrm{Var}(\frac{1}{n}\sum_{i=1}^nx_i) = \mathrm{Var}(\sum_{i=1}^n \frac{1}{n}x_i) \\ &amp;= \sum_{i=1}^n \frac{1}{n^2}\mathrm{Var}(x_i) = \frac{1}{n^2}\sum_{i=1}^n\mathrm{Var}(x_i). \end{aligned}\] <p>Since $x_1$, $x_2$, …, $x_n$ are a random sample from a distribution with variance $\sigma^2$, it follows that for each $i = 1, 2, …, n$: $\mathrm{Var}(x_i)=\sigma^2$. Thus, the variance of the sample mean can be further transformed to:</p> \[\mathrm{Var}(\bar{x}) = \frac{1}{n}\sigma^2.\] <p>Now, we know that the uncorrected sample variance is $s_n^2 = \frac{n-1}{n}\sigma^2$. Thus, the corrected one would be:</p> \[\begin{aligned} s^2 &amp;= \frac{n}{n-1}s_n^2 = \frac{n}{n-1}\cdot \frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2 \\ &amp;= \frac{1}{n-1}\sum_{i=1}^n(x_i-\bar{x})^2. \end{aligned}\] <h2 id="reference">Reference</h2> <ul> <li><a href="https://en.wikipedia.org/wiki/Bessel%27s_correction" rel="external nofollow noopener" target="_blank">Bessel Correction Wiki</a></li> <li><a href="https://online.stat.psu.edu/stat414/lesson/8/8.5" rel="external nofollow noopener" target="_blank">PennState Statistics Lecture Sample Means and Variance</a></li> <li><a href="https://online.stat.psu.edu/stat414/lesson/24/24.4" rel="external nofollow noopener" target="_blank">PennState Statistics Lecture Mean and Variance of Sample Mean</a></li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/Columnspace-and-Nullspace-of-a-Matrix-A-and-the-Solvability-of-Ax=b/">Columnspace and Nullspace of a Matrix A and the Solvability of Ax = b</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/Introduction-of-Common-Optimizers-in-Deep-Learning/">Introduction of Common Optimizers in Deep Learning</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/Understanding-the-Gumbel-Softmax-Trick/">Understanding the Gumbel-Softmax Trick</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/Introduction-of-Principal-Components-Analysis-(Chinese)/">Introduction of Principal Components Analysis (Chinese)</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Zeyun Zhong. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>