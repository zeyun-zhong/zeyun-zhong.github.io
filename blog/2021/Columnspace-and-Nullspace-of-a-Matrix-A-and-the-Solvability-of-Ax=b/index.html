<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Columnspace and Nullspace of a Matrix A and the Solvability of Ax = b | Zeyun Zhong</title> <meta name="author" content="Zeyun Zhong"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?e087b27490cd3d072797d04d4fc7ed65"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/luna.jpeg?3412bc233bd226753623e0a45dbe37de"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zeyun-zhong.github.io/blog/2021/Columnspace-and-Nullspace-of-a-Matrix-A-and-the-Solvability-of-Ax=b/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Zeyun </span>Zhong</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Columnspace and Nullspace of a Matrix A and the Solvability of Ax = b</h1> <p class="post-meta">August 17, 2021</p> <p class="post-tags"> <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="1-column-space">1. Column Space</h2> <p>The column space denoted by $\boldsymbol{C(A)}$ contains all linear combinations of the columns of matrix $\boldsymbol{A}$ ($m\times n$). It is a subspace of $\mathbb{R}^m$, since the largest dimension it can reach is the dimension of the $\boldsymbol{b}$-vector. We illustrate by a system of $m=3$ equations and $n=2$ unknowns:</p> \[\left[ \begin{matrix} 1 &amp; 0 \\ 5 &amp; 4 \\ 2 &amp; 4 \end{matrix} \right] \left[ \begin{matrix} u \\ v \end{matrix} \right] = \left[ \begin{matrix} b_1 \\ b_2 \\b_3 \end{matrix} \right]. \tag{1}\] <p>As we have more equations than unknowns in this example, and this usually means there will be no solution. One example is illustrated in the figure below. Since there is no point which belongs to all of three lines, the system has no solution.</p> <p><img src="/assets/images/Linear%20Algebra/overdetermined_system.png" alt="" class="align-center"> <em>Figure 1. Linear System with 3 Equations and 2 Unknows.</em></p> <p>But there is still chance that the system will be solvable for a subset of all possible $\boldsymbol{b}$s. One way to check this is to check if $\boldsymbol{b}$ lies in the column space. We can reformulate the equation (1) by columns:</p> \[u\left[ \begin{matrix} 1 \\ 5 \\ 2 \end{matrix} \right] + v\left[ \begin{matrix} 0 \\ 4 \\ 4 \end{matrix} \right] = \left[ \begin{matrix} b_1 \\ b_2 \\ b_3 \end{matrix} \right]. \tag{2}\] <p>We can describe all combinations of the two columns geometrically: $\boldsymbol{Ax}=\boldsymbol{b}$ can be solved if and only if $\boldsymbol{b}$ lies in the plane that is spanned by the two column vectors (Figure 2). If $\boldsymbol{b}$ lies off the plane, then it is not a combination of the two columns, corresponding to no solution of the linear system.</p> <p><img src="/assets/images/Linear%20Algebra/columnspace.png" alt="" class="align-center"> <em>Figure 2. The column space C(A), a plane in three-dimensional space.</em></p> <h2 id="2-nullspace">2. Nullspace</h2> <p>The nullspace of a matrix consists of all vectors $\boldsymbol{x}$ such that $\boldsymbol{Ax}=\boldsymbol{0}$. It is denoted by $\boldsymbol{N(A)}$. It is a subspace of $\mathbb{R}^n$, since the $\boldsymbol{x}$-vector is $n$-dimensional.</p> <h2 id="3-echelon-form-and-row-reduced-form">3. Echelon Form and Row Reduced Form</h2> <p>Let us now review the echelon form und the row reduced echelon form of a matrix $\boldsymbol{A}$. Suppose we have a 3 by 4 matrix:</p> \[\boldsymbol{A} = \left[ \begin{matrix} 1 &amp; 3 &amp; 3 &amp; 2 \\ 2 &amp; 6 &amp; 9 &amp; 7 \\ -1 &amp; -3 &amp; 3 &amp; 4 \end{matrix} \right]\] <p>After doing <a href="https://en.wikipedia.org/wiki/Gaussian_elimination" rel="external nofollow noopener" target="_blank">row reduction</a>, we get the echelon matrix $\boldsymbol{U}$:</p> \[\boldsymbol{U} = \left[ \begin{matrix} \mathbf{1} &amp; 3 &amp; 3 &amp; 2 \\ 0 &amp; 0 &amp; \mathbf{3} &amp; 3 \\ 0 &amp; 0 &amp; 0 &amp; 0 \end{matrix} \right]\] <p>The first nonzero entries in their rows are called pivots (in bold typeface). The rows contain pivots are the pivot rows and the columns contain pivot are the pivot columns. In this example, we have two pivot rows and two pivot columns.</p> <p>We can go further than $\boldsymbol{U}$, to make the matrix even simpler: first make all pivots 1 and then produce zero above the pivots. The final result is the reduced row echelon form $\boldsymbol{R}$.</p> \[\left[ \begin{matrix} 1 &amp; 3 &amp; 3 &amp; 2 \\ 0 &amp; 0 &amp; 3 &amp; 3 \\ 0 &amp; 0 &amp; 0 &amp; 0 \end{matrix} \right] \rightarrow \left[ \begin{matrix} 1 &amp; 3 &amp; 3 &amp; 2 \\ 0 &amp; 0 &amp; 1 &amp; 1 \\ 0 &amp; 0 &amp; 0 &amp; 0 \end{matrix} \right] \rightarrow \left[ \begin{matrix} 1 &amp; 3 &amp; 0 &amp; -1 \\ 0 &amp; 0 &amp; 1 &amp; 1 \\ 0 &amp; 0 &amp; 0 &amp; 0 \end{matrix} \right] = \boldsymbol{R}.\] <h2 id="4-pivot-variables-free-variables-and-rank">4. Pivot Variables, Free Variables and Rank</h2> <p>The pivots are crucial to read off all the solutions to $\boldsymbol{Rx}=\boldsymbol{0}$.</p> \[\boldsymbol{Rx}= \left[ \begin{matrix} \mathbf{1} &amp; 3 &amp; \mathbf{0} &amp; -1 \\ \mathbf{0} &amp; 0 &amp; \mathbf{1} &amp; 1 \\ \mathbf{0} &amp; 0 &amp; \mathbf{0} &amp; 0 \end{matrix} \right] \left[ \begin{matrix} u \\ v \\ w \\ y \end{matrix} \right] = \left[ \begin{matrix} 0 \\ 0 \\ 0 \end{matrix} \right] \tag{3}\] <p>The unknows $u$, $v$, $w$, $y$ can be divided into two groups: <strong>pivot variables</strong> which correspond to the pivot columns (in boldface), and <strong>free variables</strong>, corresponging to columns without pivots. Accoring to Equation 3, the pivot variables are completely determined in terms of the freee variables $v$ and $y$:</p> \[\begin{aligned} u + 3v - y &amp;= 0 \quad &amp;\text{yields} \quad u &amp;= -3v + y \\ w + y &amp;= 0 \quad &amp;\text{yields} \quad w &amp;= -y \end{aligned} \tag{4}\] <p>If we set $v=1, y=0$ and $v=0, y=1$, then we get two special solutions. The complete solution to $\boldsymbol{Rx}=\mathbf{0}$, or equivalently to $\boldsymbol{Ax}=\mathbf{0}$, is a combination of these two special solutions:</p> \[\boldsymbol{x} = \left[ \begin{matrix} -3v+y \\ v \\ -y \\ y \end{matrix} \right] =v \left[ \begin{matrix} -3 \\ 1 \\ 0 \\ 0 \end{matrix} \right] + y \left[ \begin{matrix} 1 \\ 0 \\ -1 \\ 1 \end{matrix} \right]. \tag{5}\] <p>Each free variable produces its own special solution. The nullspace $\boldsymbol{N(A)}$ is therefore generated by these special solutions and the dimension of the nullspace corresponds to the number of the free variables.</p> <p>On the other side, the pivot variables count for the column space. The number of pivot variables $r$ corresponds to the number of independent columns (and independent rows) of matrix $\boldsymbol{A}$, which is also called the <strong>rank</strong> denoted by $rank(\boldsymbol{A})$.</p> <h2 id="5-solving-axb-uxc-and-rxd">5. Solving Ax=b, Ux=c, and Rx=d</h2> <p>The case $\boldsymbol{b} \neq \mathbf{0}$ is quite different from $\boldsymbol{b} = \mathbf{0}$. The row operations on $\boldsymbol{A}$ must act also on the right-hand side ($\boldsymbol{b}$). For the original example $\boldsymbol{Ax}=\boldsymbol{b}$, apply to both sides the operations that led from $\boldsymbol{A}$ to $\boldsymbol{U}$. The result is an upper triangular system $\boldsymbol{Ux} = \boldsymbol{c}$:</p> \[\left[ \begin{matrix} 1 &amp; 3 &amp; 3 &amp; 2 \\ 0 &amp; 0 &amp; 3 &amp; 3 \\ 0 &amp; 0 &amp; 0 &amp; 0 \end{matrix} \right] \left[ \begin{matrix} u \\ v \\ w \\ y \end{matrix} \right] = \left[ \begin{matrix} b_1 \\ b_2 - 2b_1 \\ b_3 - 2b_2 + 5b_1 \end{matrix} \right]. \tag{6}\] <p>To make the system solvable, the vector $\boldsymbol{b}$ must lie in the column space generated by the pivot columns (column 1 and 3 in this case). Equivalently, all vectors $\boldsymbol{b}$ in that space must satisfy $b_3 - 2b_2 + 5b_1 = 0$. Here we choose $\boldsymbol{b} = (1,5,5)$ and back-substitution gives:</p> \[\begin{aligned} 3w + 3y &amp;= 3 \quad &amp;\text{or} \quad w &amp;= 1 - y \\ u + 3v + 3w + 2y &amp;= 1 \quad &amp;\text{or} \quad u &amp;= -2 - 3v + y. \end{aligned} \tag{7}\] <p>Setting all free variables ($v$ and $y$) to zero, we get a particular solution $\boldsymbol{x_p} = (-2, 0, 1, 0)$. Since every solution to $\boldsymbol{Ax}=\boldsymbol{b}$ is the sum of one particular solution and a solution to $\boldsymbol{Ax}=\mathbf{0}$:</p> \[\boldsymbol{x}_\text{complete} = \boldsymbol{x}_\text{particular} + \boldsymbol{x}_\text{nullspace}.\] <p>The complete solution would be:</p> \[\boldsymbol{x} = \left[ \begin{matrix} u \\ v\\ w \\ y \end{matrix} \right] = \left[ \begin{matrix} -2 \\ 0 \\ 1 \\ 0 \end{matrix} \right] + v \left[ \begin{matrix} -3 \\ 1 \\ 0 \\ 0 \end{matrix} \right] + y \left[ \begin{matrix} 1 \\ 0 \\ -1 \\ 1 \end{matrix} \right]. \tag{8}\] <p>When the equation was $\boldsymbol{Ax}=\mathbf{0}$, the particular solution was the zero vector! The reduced form $\boldsymbol{R}$ makes this solution even clearer. However, this process will not be repeated here.</p> <h2 id="6-number-of-possible-solutions-of-axb">6. Number of Possible Solutions of Ax=b</h2> <p>After introducing the previous sections, we are finally able to conclude the solvability of a linear system $\boldsymbol{Ax}=\mathbf{b}$ and the possible number of solutions.</p> <p>Still remember the definition of the rank introduced in Section 4.? It is the number of pivot variables and also the maximal number of linearly independent columns (and rows) of matrix $\boldsymbol{A}$. It is crucial for analysis of the solvability of a linear system.</p> <ul> <li>$r = m = n$: Since the number of free variables ($n-r$) equals zero, there are no free variables, leading to one single solution. The matrix $\boldsymbol{A}$ is invertible.</li> <li>$r = n &lt; m$: There are still no free variables, since $n-r = 0$. However, there are zero rows in the echelon form $\boldsymbol{U}$ or in the reduced form $\boldsymbol{R}$, like in Equation 6. This means, there are certain constraints the $\boldsymbol{b}$-vector must satisfy. Thus, there could be one single solution or no solution. Another way to think of it: The dimension of the column space is smaller than the dimension of the $\boldsymbol{b}$-vector. If $\boldsymbol{b}$ lies off the column space, then there is no solution.</li> <li>$r = m &lt; n$: There are free variables, corresponding to infinitely many solutions.</li> <li>$r &lt; m$, $r &lt; n$: There are free variables and zero rows in $\boldsymbol{U}$ and $\boldsymbol{R}$. So there will be either infinitely many solutions or no solution.</li> </ul> <p>Here is a table to summarize the conclusions above:</p> <table> <thead> <tr> <th> </th> <th>No. of free variables</th> <th>No. of zero rows in $\boldsymbol{U}$ or $\boldsymbol{R}$</th> <th>No. of possible solutions</th> </tr> </thead> <tbody> <tr> <td>$r = m = n$</td> <td>0</td> <td>0</td> <td>1</td> </tr> <tr> <td>$r = n &lt; m$</td> <td>0</td> <td>$m-r$</td> <td>0 or 1</td> </tr> <tr> <td>$r = m &lt; n$</td> <td>$n-r$</td> <td>0</td> <td>$\infty$</td> </tr> <tr> <td>$r &lt; m$, $r &lt; n$</td> <td>$n-r$</td> <td>$m-r$</td> <td>0 or $\infty$</td> </tr> </tbody> </table> <h2 id="reference">Reference</h2> <ul> <li>Strang, G. (2006). Linear Algebra and Its Applications, 4th Edition (4th edition). Belmont, CA: Cengage Learning.</li> <li><a href="https://www.youtube.com/watch?v=9Q1q7s1jTzU&amp;list=PL49CF3715CB9EF31D&amp;index=8&amp;ab_channel=MITOpenCourseWare" rel="external nofollow noopener" target="_blank">Lectures on Linear Algebra from Gilbert Strang</a></li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/Introduction-of-Common-Optimizers-in-Deep-Learning/">Introduction of Common Optimizers in Deep Learning</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/sample_variance/">Why is the Denominator of Sample Variance n-1?</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/Introduction-of-Principal-Components-Analysis-(Chinese)/">Introduction of Principal Components Analysis (Chinese)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/Understanding-the-Gumbel-Softmax-Trick/">Understanding the Gumbel-Softmax Trick</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Zeyun Zhong. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>